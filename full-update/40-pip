#!/usr/bin/env sh
set -e

export PIP_REQUIRE_VIRTUALENV=0

if ! command -v pip > /dev/null; then
    exit
fi

if ! [ -x "$(command -v pip)" ] || [ "$(pip list | grep -c -e '^pip ' -e '^setuptools ' -e '^wheel ')" != '3' ]; then
    python -m ensurepip --user --default-pip
    python -m pip install --user --upgrade --force-reinstall pip setuptools wheel
fi

ood_packages="$(pip list --outdated --format=freeze)"
if [ -n "${ood_packages}" ]; then
    pip install --user --upgrade $(pip freeze --all | cut -d = -f 1)
fi
