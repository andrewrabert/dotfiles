#!/usr/bin/env bash
container_name="docker_shell-$(uuidgen)"
trap "docker kill "${container_name}"" SIGHUP

args=()
if [[ $1 == '-s' ]]; then
    shift;
    args=(--entrypoint /bin/sh "${args[@]}")
fi

args=("${args[@]}" "$@")

# Ugh - docker run needs a --pull flag
# https://github.com/moby/moby/issues/13331
if [[ $1 != '-*' ]]; then
    docker pull $1 > /dev/null
fi

docker run --rm -it --name "${container_name}" "${args[@]}"
